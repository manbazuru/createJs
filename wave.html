<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>波を作ってみる</title>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script src="https://code.createjs.com/createjs-2015.11.26.min.js"></script>
<link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body>
<div>
  <h1>波を作ってみる</h1>
</div>
<div class="canvas">
    <canvas id="canvas" height="400"></canvas>
  </div>
<script>
var canvasWidth = $('.canvas').width();
$('canvas').attr('width',canvasWidth);

/*
var canvas,stage;
var wave;
var count,range,curveX,curveY,oldX,oldY,newX,newY;

var init = function() {
  canvas = document.getElementById('canvas');
  stage = new createjs.Stage(canvas);

  count = 0;
  oldX = 0;
  oldY = 0;

  wave = new createjs.Shape();
  stage.addChild(wave);

  createjs.Ticker.timingMode = createjs.Ticker.RAF;
  createjs.Ticker.addEventListener('tick',mytick);
};

function mytick() {
  wave.graphics
    .beginFill('slategray')
    .beginStroke('slategray')
    .moveTo(0,canvas.height)
    .lineTo(0,canvas.height / 2);

  for(var i = 0; i <30; i++) {
    newX = i * (canvas.width / 30);
    range = calcY(i);
    newY = range * 30 + canvas.height / 2;
    curveX = oldX + (newX - oldX) / 2;
    curveY = oldY + (newY - oldY) / 2;

    wave.graphics
      .quadraticCurveTo(curveX,curveY,newX,newY);
    oldX = newX;
    oldY = newY;
  }

  wave.graphics
    .lineTo(canvas.width,canvas.height)
    .lineTo(0,canvas.height)
    .lineTo(0,canvas.height / 2)
    .closePath();

  stage.update();
}

// .quadraticCurveTo(経由点X,経由点Y,着地点X,着地点Y);

function calcY(num){
  var rad = 0;
  count += 0.001;
  rad += Math.sin(num * Math.PI / 180 + count);
  return rad;
}
init();
*/





var wave;
var canvas = document.getElementById('canvas');
var stage = new createjs.Stage(canvas);

wave = new createjs.Shape();
stage.addChild(wave);
wave.graphics.beginStroke('slategray');

createjs.Ticker.timingMode = createjs.Ticker.RAF;
createjs.Ticker.addEventListener('tick',makewave);

var W = 100;
var canvasWidth = canvas.width;
var canvasHeight = canvas.height;
var level = 30;
var count = 0;

var oldX = 0;
var oldY = 0;

function makewave() {
  wave.graphics.moveTo(0, canvasHeight);
  wave.graphics.lineTo(0, canvasHeight / 2);

  for (var i = 0; i < W; i++) {
    var newX = i * (canvasWidth / W);
    var newY = calcY(i) * level + canvasHeight / 2;
    var cx = oldX + (newX - oldX) / 2;
    var cy = oldY + (newY - oldY) / 2;
    wave.graphics.quadraticCurveTo(cx, cy, newX, newY);
    oldX = newX;
    oldY = newY;
  }

  wave.graphics.lineTo(canvasWidth, canvasHeight);
  wave.graphics.lineTo(0, canvasHeight);
  wave.graphics.closePath();

  stage.update();
}

function calcY(num){
  var rad = 0;
  count += 0.001;
  rad += Math.sin(num * Math.PI / 180 + count);
  return rad;
}






/*
this.obj = this.obj || {};
var __extends = this.__extends || function(child, parent){
    for (var p in parent){
        if (parent.hasOwnProperty(p)){
            child[p] = parent[p];
        }
    }
    function __(){
        this.constructor = child;
    }
    __.prototype = parent.prototype;
    child.prototype = new __();
};

(function (obj){

    var Main = (function(){
        function Main(){
            var that = this;
            this.count = 0;
            this.stage = new createjs.Stage(document.getElementById("canvas"));

            createjs.Ticker.timingMode = createjs.Ticker.RAF;
            createjs.Ticker.addEventListener("tick", function(e){that.onTickerEvent(e)});

            this.init();
        }

        var p = Main.prototype;

        p.init = function(){
            this.wave = new Wave();
            this.wave.setup(this.stage.canvas.width,this.stage.canvas.height);
            this.stage.addChild(this.wave);
        }

        p.onTickerEvent = function(e){
            if(this.wave){
                this.wave.update();
            } 
        }
        return Main;
    })();

     var Wave = (function(_super){
        __extends(Wave, _super);

        function Wave(){
            _super.call(this);

            this.count = 0;
            this.baseNum = 100;
            this.canvasW = 0;
            this.canvasH = 0;
            this.level = 30;
        }

        var p = Wave.prototype;

        p.update = function(){
            var oldX = 0;
            var oldY = 0;

            this.graphics.clear()
            .beginFill("#44c2ff")
            .moveTo(0, this.canvasH)
            .lineTo(0, this.canvasH*0.5);

            for (var i=0; i<=this.baseNum; i++) {
                var posX = i * (this.canvasW / this.baseNum);
                var rad = this.culcY(i);
                var posY = rad * this.level + this.canvasH / 2;
                var curvX = oldX + (posX - oldX) / 2;
                var curvY = oldY + (posY - oldY) / 2;

                this.graphics.quadraticCurveTo(curvX, curvY, posX, posY);

                oldX = posX;
                oldY = posY;
            }

            this.graphics.lineTo(this.canvasW, this.canvasH);
            this.graphics.lineTo(0, this.canvasH);
            this.graphics.closePath();
            
            this.getStage().update();
        }

        p.setup = function(nW, nY){
            this.canvasW = nW;
            this.canvasH = nY;
        }

        p.culcY = function(num){
            var rad = 0;
            this.count += 0.001;
            rad += Math.sin(num * Math.PI / 180 + this.count);
            return rad;
        }
        return Wave;
     })(createjs.Shape);

    obj.Main = Main;
    
})(obj);

window.onload = function(){return new obj.Main();};
*/



</script>
</body>
</html>